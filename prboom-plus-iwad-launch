#!/bin/bash

# if "$SNAP/doom-engine" exists we can expect this to run
# as a content snap within, say, a DOOM map editor.
# On the confinement side the script runs within the parents sandbox.

if [ -d "$SNAP/doom-engine" ]; then
    export SNAP="${SNAP}/doom-engine"
fi

export DOOMWADDIR="${SNAP}/share/games/doom/"

if [ "$@" == "" ]; then
    IWAD_FILENAME=`zenity \
      --file-selection \
      --title='Select the *.wad to play' \
      --file-filter='WAD file | *.wad *.WAD *.iwad *.IWAD *.pwad *.PWAD'`
    exec "desktop-launch" "prboom-plus" "-iwad" "$IWAD_FILENAME"
else
    exec "desktop-launch" "prboom-plus" "$@"
fi
